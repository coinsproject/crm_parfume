# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
cd /opt/crm_parfume/crm_parfume
chmod +x check_server.sh
./check_server.sh
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- ‚úÖ –ì–¥–µ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Docker –∏ Docker Compose
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ù–∞–π–¥–µ–Ω –ª–∏ docker-compose.yml
- ‚úÖ –ï—Å—Ç—å –ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

---

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "docker-compose: command not found"

#### –†–µ—à–µ–Ω–∏–µ A: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å docker-compose (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)

```bash
# –î–ª—è Ubuntu/Debian:
sudo apt-get update
sudo apt-get install docker-compose

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:
docker-compose --version
```

#### –†–µ—à–µ–Ω–∏–µ B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker compose (–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–∏ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è:
docker compose version

# –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç update.sh –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

–ï—Å–ª–∏ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ `/opt/crm_parfume/crm_parfume` –∏ —Ç–∞–º –Ω–µ—Ç `docker-compose.yml`:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
ls -la

# 2. –ù–∞–π–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
find /opt -name "docker-compose.yml" 2>/dev/null

# 3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
cd /opt/crm_parfume  # –∏–ª–∏ –∫—É–¥–∞ –ø–æ–∫–∞–∑–∞–ª find

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
ls -la
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã: docker-compose.yml, Dockerfile, update.sh
```

#### –ï—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è:

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ
cd /opt/crm_parfume/crm_parfume
mv * ../
mv .* ../
cd ..
rmdir crm_parfume

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /opt/crm_parfume  # –µ—Å–ª–∏ —Ç–∞–º –µ—Å—Ç—å docker-compose.yml
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –°–∫—Ä–∏–ø—Ç –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
chmod +x update.sh
chmod +x check_server.sh
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Docker –∫–æ–º–∞–Ω–¥

```bash
# –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker:
sudo usermod -aG docker $USER

# –í—ã–π–¥–∏—Ç–µ –∏ –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞, –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
newgrp docker

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
docker ps
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 5: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞. –ë–∞–∑–∞ —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–ï—Å–ª–∏ –±–∞–∑–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å, –Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:

```bash
# –ù–∞–π–¥–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
find /opt -name "crm.db" 2>/dev/null

# –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ:
mkdir -p ./data
cp /–ø—É—Ç—å/–∫/crm.db ./data/crm.db
```

---

## –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è

–°—É–¥—è –ø–æ –≤–∞—à–µ–º—É –ø—É—Ç–∏ `/opt/crm_parfume/crm_parfume`, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```bash
cd /opt/crm_parfume/crm_parfume
ls -la
```

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- `docker-compose.yml` ‚úÖ
- `Dockerfile` ‚úÖ
- `update.sh` ‚úÖ
- `app/` (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è) ‚úÖ

**–ï—Å–ª–∏ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –Ω–µ—Ç:**

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ:
cd /opt/crm_parfume
ls -la

# –ï—Å–ª–∏ —Ç–∞–º –µ—Å—Ç—å docker-compose.yml, —Ä–∞–±–æ—Ç–∞–π—Ç–µ –æ—Ç—Ç—É–¥–∞
```

### 2. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
cd /opt/crm_parfume/crm_parfume  # –∏–ª–∏ /opt/crm_parfume
git pull origin main
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:

```bash
chmod +x check_server.sh
./check_server.sh
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker Compose (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
docker --version
docker compose version  # –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
docker-compose --version  # —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è

# –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
sudo apt-get update
sudo apt-get install docker-compose
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

```bash
chmod +x update.sh
sudo ./update.sh
```

---

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

```bash
# 1. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è?
[ -f docker-compose.yml ] && echo "‚úì OK" || echo "‚úó –ù–ï–¢ docker-compose.yml"

# 2. Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω?
command -v docker &> /dev/null && echo "‚úì Docker OK" || echo "‚úó Docker –ù–ï–¢"

# 3. Docker Compose –¥–æ—Å—Ç—É–ø–µ–Ω?
(docker-compose --version || docker compose version) &> /dev/null && echo "‚úì Docker Compose OK" || echo "‚úó Docker Compose –ù–ï–¢"

# 4. –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π?
[ -x update.sh ] && echo "‚úì update.sh –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π" || echo "‚úó –ù—É–∂–Ω–æ: chmod +x update.sh"
```

---

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# 1. –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î (–µ—Å–ª–∏ –µ—Å—Ç—å)
mkdir -p backups
cp data/crm.db backups/crm_backup_$(date +%Y%m%d_%H%M%S).db

# 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
git pull origin main

# 3. –ó–∞–ø—É—Å–∫ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—É –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç)
docker-compose up -d
# –∏–ª–∏
docker compose up -d

# 4. –ú–∏–≥—Ä–∞—Ü–∏–∏
docker-compose exec crm alembic upgrade head
# –∏–ª–∏
docker compose exec crm alembic upgrade head
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose

```bash
# –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é (–µ—Å–ª–∏ –µ—Å—Ç—å):
sudo apt-get remove docker-compose

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—É—é:
sudo curl -L "https://github.com/docker/compose/releases/download/v2.23.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
docker-compose --version
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `./check_server.sh` –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—ã–≤–æ–¥
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs` –∏–ª–∏ `docker compose logs`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å `docker-compose.yml`



